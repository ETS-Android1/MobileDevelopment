# Расходы на серверную часть (backend)

Приведена условная оценка расходов на оплату услуг хостинга севера и баз данных. Расходы на персонал, налоги, и т.д. - вне данного обзора.

## Основные статьи расходов

* Хостинг VPS сервера для работы приложения  
* SSL-сертификаты, аренда доменного имени  
* Хостинг базы данных. Может выполняться VPS сервером, но отдельный специализированный хостинг может быть более эффективным по причине оптимизации оборудования под задачи баз данных (много ОЗУ, быстрая дисковая подсистема, кэширующие кластеры, и т.д.)  
* Использование облачных API для выполнения специализированных задач (например, Google Maps)
* Оплата отправки e-mail и SMS для регистрации пользователя, восстановления пароля
* Лицензия разработчика для мобильных платформ

## Оценка расходов на хостинг (минимальные, уровень - hobby)

4 ARMv8, 2 GB за 3 фунта/месяц (UK)
https://www.scaleway.com/pricing/#anchor_arm

1 Core, 2GB за 3 евро/месяц (Germany, Finland)
https://www.hetzner.com/cloud-ru

Россия: 1 Core 1Gb - 400 руб/месяц
https://vscale.io/

Россия: 1 Core 1Gb - 220 руб/месяц
https://neoserver.ru/

Heroku: 512 Mb, Never Sleeps - $7/месяц. В общем случае, на Heroku осуществляется публикация приложения - это не полноценный VPS
https://www.heroku.com/pricing

AWS: 1 Core 1Gb t2.micro + DynamoDB - оценка в $27/месяц. Ключевое ограничение AWS - оплата постфактум. В случае ошибок конфигурирования сервисов, или ошибок в коде, можно получить "золотой чек" на оплату, который придётся оплатить.

База данных на mLab.com (куплен MongoDB): https://mlab.com/plans/pricing/ - SHARED - $15/Gb

База данных на MongoDB Atlas: https://www.mongodb.com/cloud/atlas/pricing - $9/месяц. Есть ограниченный бесплатный тариф.

## Альтернативы

[Firebase](https://firebase.google.com/pricing/). В 2020 году Google Cloud отказался от комфортного Flame Plan ($25/месяц) и запустил альтернативу **Blaze plan** - Pay as you go. Тарифицируется каждое действие, каждый запрос. Программирование должно быть исключительно аккуратным. Так, например, если на форме есть список товаров, список товаров в корзине, список текущих акций и список наиболее популярных товаров в группе, это может потребовать четырёх запросов и чек может быть кратно выше, чем его первоначальная оценка. Практический опыт использования изложен в статье *Mohammad Faisal*
 [Costly Mistakes: Why We Had to Abandon Firebase](https://medium.com/javascript-in-plain-english/costly-mistakes-why-we-had-to-abandoned-firebase-b89930c10d92).

[Parse Server](https://parseplatform.org/) на AWS - аренда VPS на Amazon (комплексная формула).

[Feathers.js](https://feathersjs.com/) - нужно исследовать, но вроде бы использует аутентификацию GitHub, что является бесплатным.

## Стоимость доменного имени

Стоимость доменного имени для зоны ".com" при покупке на AWS составляет $12, а для ".net" - $11. Дополнительные затраты на хостинг DNS (AWS Route53) составляют $0.50/месяц за одну зону хостинга. Цены [Zenon (Россия)](https://www.zenon.net/domains/): 280 руб/год за ".ru" и 882 руб/год за ".com".

## Стоимость системы рассылки электронной почты

Электронная почта используется для регистрации нового пользователя и в случае, если пользователь забыл пароль и хочет его восстановить. Отправкой почты занимаются сервисы, такие как [SendGrid](https://sendgrid.com/). Стоимость отправки 100 тысяч писем в месяц начинается с $15/месяц.

Подобный сервис необходимо использовать и для рассылки SMS с теми же целями.

## Стоимость SSL-сертификатов

Публичный сертификат можно получить у специализированной компании сформировав запрос на выпуск сертификата CSR (**Certificate Signing Request**). В CSR указывается подробная информация о компании, для которой сгенерирован сертификат. Центр сертификации проводит проверку всех указанных данных (именно это составляет основной вклад в сумму оплаты услуги).

Существуют разные типы сертификатов, которые применяются к разным уровням проверки комапании и применимости к другим доменным именам. Например:

1. Обычные SSL-сертификаты только подтверждаю домен. Стоят $18-22/год
2. Wildcard-сертификаты требуются если используются суб.домены на сайте, например: zheka.rozhkov.ru. Стоимость от $190/год
3. Сертификат для сервера, на котором хостятся сайты для разных доменов – от $400/год

Стоимость SSL-сертификата **Thawte SSL WebServer** на [Zenon](https://www.zenon.net/ssl/) составляет 6384 руб/год.

Статья о "бесплатном" получении SSL сертификата на AWS: https://hackernoon.com/getting-a-free-ssl-certificate-on-aws-a-how-to-guide-6ef29e576d22.

Бесплатные сертификаты можно сгенерировать на [Let's Encrypt](https://letsencrypt.org/ru/getting-started/).

## Стоимость использования сервиса доступа к картам

https://developers.google.com/maps/billing/understanding-cost-of-use

Нужно вчитываться - услуг очень много и цена до $0.10/запрос. Из рекламы Google для коммерческих проектов: "*For most of our users, the $200 monthly credit is enough to support their needs. You can also set daily quotas to protect against unexpected increases*".

Бесплатный лимит вызовов Geocoder - 10.000/месяц.

По Yandex.Maps: https://tech.yandex.com/maps/commercial/

С дневным лимитом в 1000 запросов, стоимость - 120 тысяч рублей/год.

## Лицензия разработчика (возможность публикации в магазине приложений)

Google Play - $25/единожды  
Apple AppStore - $100/год

В случае использования React Native с [Expo](https://expo.io/), установка приложений может осуществляться через клиент Expo. Распространение приложений осуществляется посредством push-сервиса, но в бесплатном тарифе, сборка приложения осуществляется в "порядке общей очереди", т.е. сборка и публикация может занять несколько часов (даже десятки). Для того, чтобы попасть в начало очереди, следует использовать специализированный [тарифный план Priority](https://expo.io/developer-services), который стоит $29/месяц.

## Вспомогательные средства тестирования

Для тестирования доступа к приложению из разных географическим мест, можно воспользоваться VPN. Одним из наиболее удобных является [HideMyName](https://hidemy.name/ru/). Месяц стоит 470 руб, а год - 2280 руб.

# DDNS - noip.com

Существует возможность переадрессовывать сетевой трафик на домашние компьютеры, используя Dynamic-DNS. При загрузке, или изменении локального IP-адреса, компьютер отправляет на специализированный сервис свой IP-адрес (внутренний) и адрес-proxy (внешний). В случае, если сервис будет получать запросы на свой адрес, ассоциированный с домашним компьютером, он пытается создать тунель до домашенего компьютера и передать сетевой трафик на этот компьютер.

Один из наиболее известных сервисов DDNS, у которого есть бесплатный тарифный план: https://www.noip.com/

Компания разработчик опубликовала открытый протокол, который поддерживает множество сетевого оборудования (маршрутизаторы). Устанавливается клиент, который контролирует IP-адрес компьютера и если он изменяется, то отправляет в сервис изменённый IP-адрес. Внешние пользователи используют зарегистрированное пользователем доменное имя (от 1 до 3 на пользователя - бесплатно) и переадресуют запрос на конечное устройство пользователя.

Можно применять к RPi 3/4. Искал: [How to Install No-IP on Raspberry Pi](https://www.slicethepi.co.uk/how-to-install-no-ip-on-raspberry-pi/)
